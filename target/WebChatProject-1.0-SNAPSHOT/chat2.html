<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="chat2.css">
  <script type="text/javascript" src="startChat.js"></script>
  <script type="text/javascript" src="addnewroom.js"></script>
  <script type="text/javascript" src="loadMess.js"></script>
</head>
<body>
    <div id="testagain"></div>
    <div class="container-fluid">
         <div class="row">
            <div class="col-3 left-head">
                <button class="avatar01"><img data-toggle="modal" data-target="#myModal3" class="rounded-circle my-avatar"></button>
                <span class="name" style="color:rgb(39, 75, 173);" id="user-name"><b>Thanh</b></span>
                <button type="button" title="mới" class="icon" data-toggle="modal" data-target="#myModal"><i class="fa fa-plus-circle"></i></button>
                <button id="edit" type="button" title="chỉnh sửa" class="icon"><i class="fa fa-edit"></i></button>
                <div id="menu-edit" class="action_menu">
                    <ul>
                        <li data-toggle="modal" data-target="#myModal2"><i class="fa fa-users"></i>Add Member</li>
                        <li id="quitRoom"><i class="fa fa-sign-out"></i>Quit Room</li>
                        <li id="deleteRoom"><i class="fa fa-trash"></i>Delete Conversation</li>
                        <li><i class="fa fa-search"></i>Search</li>
                    </ul>
                </div>
                <button type="button" title="cài dặt" id="cog" class="icon"><i class="fa fa-cog"></i></button>
                <div id="menu-cog" class="action_menu">
                    <ul>
                        <li data-toggle="modal" data-target="#myModal3"><i class="fa fa-user-circle-o"></i>Profile</li>
                        <li><i class="fa fa-users"></i>Friends List</li>
                        <li id="logout"><i class="fa fa-ban"></i>Logout</li>

                    </ul>
                        <form method="get" action="LogoutServlet" style="display: none;">
                            <input type="submit" value="Logout" id="logout-submit">
                        </form>
                </div>
            </div>
            <div class="col-9 right-head">
                <img id="img-room-avatar-1" src="" class="rounded-circle my-avatar">
                <span class="name" style="font-size: 22px;" id="insert-roomName"></span>

                

                <button type="button" title="thêm nữa" id="btn1" class="icon"><i class="fa fa-exclamation-circle"></i> </button>
                <button type="button" title="call video" class="icon"><i class="fa fa-video-camera"></i> </button>
                <button type="button" title="call" class="icon"><i class="fa fa-phone"></i> </button>
            </div>          
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-3 left">

                <!-- The Modal -->
                <div class="modal" id="myModal">
                    <div class="modal-dialog">
                    <div class="modal-content">
                <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">New Conversation</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                <!-- Modal body -->
                        <div class="modal-body">
                            <input class="name-group" type="text" placeholder="Insert Name Of New Room..." id="addNewRoom-text">
                        </div>
                <!-- Modal footer -->
                        <div class="modal-footer">

                            <button type="button" class="btn btn-danger" onclick="addNewRoom()">Ok</button>
                            
                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    </div>
                </div>
                <div class="modal" id="myModal2">
                    <div class="modal-dialog">
                        <div class="modal-content">
                    <!-- Modal Header -->
                            <div class="modal-header">
                                <h4 class="modal-title">Add Member</h4>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                    <!-- Modal body -->
                            <div class="modal-body">
                                <input type="text" id="myInput" onkeyup="searchPeople()" placeholder="Search for names.." class="name-group">
                                <ul id="myUL">
                                </ul>
                            </div>
                    <!-- Modal footer -->
                            <div class="modal-footer">
                               <button type="button" class="btn btn-danger">Ok</button>
                               <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal" id="myModal3">
                    <div class="modal-dialog">
                        <div class="modal-content">
                    <!-- Modal Header -->
                            <div class="modal-header">
                                <h4 class="modal-title">Thông tin cá nhân</h4>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                    <!-- Modal body -->
                            <div class="modal-body">
                                <div class="text-center">
                                    <img id="avat" style="height: 150px; width: 150px; display: block; margin-left: auto; margin-right: auto;" class="rounded-circle my-avatar">
                                    <h6>Upload a different photo...</h6>
                                    <form method="post" action="changeInformation" enctype="multipart/form-data" id="form_uploadFileChange" target="#changeSuccess">
                                       <input id="avat-img" type="file" name="files" class="text-center center-block file-upload" multiple>
                                    </form>
                                    <div id="changeSuccess"></div>
                                  </div><br>
                               
                                    <div>
                                          <label style="color: rgb(49, 113, 209);">First Name</label><br>
                                          <input style="width: 400px;" id="ip1" type="text" class="change-inform"><br>
                                          <label style="color: rgb(49, 113, 209);">Last Name</label><br>
                                          <input style="width: 400px;" id="ip2" type="text" class="change-inform"><br>
                                          <label style="color: rgb(49, 113, 209);">Email</label><br>
                                          <input style="width: 400px;" id="ip3" type="text" class="change-inform"><br>
                                          <label style="color: rgb(49, 113, 209);">Password</label><br>
                                          <input style="width: 400px;" id="ip4" type="text" class="change-inform"><br>
                                    </div>
                                
                            </div>
                    <!-- Modal footer -->
                            <div class="modal-footer">
                               <button class="btn btn-primary" id="update">Update</button>
                               <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="box-1">
                    <span class="icon-search"><i class="fa fa-search"></i></span>
                    <input type="search" id="search" style="background-color: rgb(230, 230, 230); width: 90%; border: none;" placeholder="Search..." />
                </div>
                <div id="removeSocket" style="display: none;" onclick="removeSocket()"></div>
                <div>
                    <ul class="chat-list" id="chat-list">
                        
                    </ul>
                </div>
            </div>
            <div id="p1" class="col-9 middle">
                <div class="mess" id="mess">
                </div>
                <div style="display: flex; height: 60px; background-color: rgb(230, 230, 230);">
                    
                        <input type="text" style="margin: 10px; width: 80%;" class="form-control" id="messageText">
                    
                    
                        <button type="button" class="icon-meh-o" title="icon"><i class="fa fa-meh-o"></i></button>
                        <button type="button" class="icon-paperclip" title="đính kèm" id="upload-btn"><i class=" fa fa-paperclip"></i></button>
                        
                        <form method="post" action="uploadFile" enctype="multipart/form-data" id="form_uploadFileMess" style="display: none;" target="#messageText">
                           <input type="file" name="files" id="upload-input" multiple>
                           <input type="submit" value="Upload" id="upload-submit"/>
                        </form>
                        <button class="send-mess" title="gửi" onclick="sendMessage();" id="btn-sendMessage">Send</button>
                </div>
            </div>
            <div id="p2" class="col-3 sub right" >
                <div>
                    <img style="height: 200px; width: 200px; display: block; margin-left: auto; margin-right: auto;" class="rounded-circle my-avatar" id="img-room-avatar-2">
                </div>
                <div>
                    <span class="name" style="color:rgb(39, 75, 173); display: flex; justify-content: center; font-size: 20px"><b>Nguyễn Văn Thanh</b></span>
                </div>
                <div>
                    <span class="" style="color:rgb(90, 90, 90); display: flex; justify-content: center; font-size: 15px; border-bottom: 1px solid rgb(230, 230, 230); margin-bottom: 10px;">đang hoạt động<i class="fa fa-circle" style="color:rgb(37, 231, 118); margin-top:5px; margin-left:5px;"></i></span>
                </div>
                <div id="div1" class="right-div">
                    <button class="right-button-main"><b>Hành động khác <i class="fa  fa-angle-left" style="float: right; margin-right: 20px; font-size: 25px"></i></b></button>
                </div>
                <div id="div11" style="display: none;">
                    <div class="right-div-child">
                        <button class="right-button"><span>Tìm kiếm trong cuộc trò chuyện</span></button>
                    </div>
                    <div class="right-div-child">
                        <button class="right-button"><span>Chỉnh sửa biệt hiệu</span></button>
                    </div>
                    <div class="right-div-child">
                        <button class="right-button"><span>Đổi chủ đề</span></button>
                    </div>
                    <div class="right-div-child">
                        <button class="right-button"><span>Thay đổi biểu tượng cảm xúc</span></button>
                    </div>
                </div>
                
                <div id="div2" class="right-div">
                    <button class="right-button-main"  id="btn-member"><b>Mọi người<i class="fa  fa-angle-left" style="float: right; margin-right: 20px; font-size: 25px"></i></b></button>
                </div>
                <div id="div21" style="display: none;">
                    <div class="people">
                        <img src="" class="rounded-circle my-avatar">
                        <span class="name" style="color:rgb(100, 100, 100);">Nguyễn Văn Thanh</span> 
                        <button type="button" class="close" data-dismiss="people">&times;</button>
                    </div>
                </div>

                <div id="div3" class="right-div">
                    <button class="right-button-main"><b>Quyền riêng tư và hỗ trợ<i class="fa  fa-angle-left" style="float: right; margin-right: 20px; font-size: 25px"></i></b></button>
                </div>
                <div id="div31" style="display: none;">
                    <div class="right-div-child">
                        <button class="right-button"><span>Thông báo</span></button>
                    </div>
                    <div class="right-div-child">
                        <button class="right-button"><span>Bỏ qua tin nhắn</span></button>
                    </div>
                    <div class="right-div-child">
                        <button class="right-button"><span>Có gì đó không ổn</span></button>
                    </div>
                </div>

                
            </div>
        </div>
    </div>

    <script language="javascript">
        
        var button1 = document.getElementById("btn1");
        var event1 = document.getElementById("p1");
        var event2 = document.getElementById("p2");

        $(document).ready(function(){
            $('#cog').click(function(){
            $('#menu-cog').toggle();
        });
        });

        $(document).ready(function(){
            $('#edit').click(function(){
            $('#menu-edit').toggle();
        });
        });

        $(document).ready(function(){
            $('#div1').click(function(){
            $('#div11').toggle();
        });
        });



        $(document).ready(function(){
            $('#update').click(function(){ 
                location.reload();
        });
        });




        $(document).ready(function(){
            $('#div2').click(function(){
            $('#div21').toggle();
        });
        });

        $(document).ready(function(){
            $('#div3').click(function(){
            $('#div31').toggle();
        });
        });
        
        $(document).ready(function(){
            $('#upload-btn').click(function(){
                $('#upload-input').click();
            });
        });

        $(document).ready(function(){
            $('#btn1').click(function(){
                event1.classList.toggle('col-9');
                event1.classList.toggle('col-6');
                event2.classList.toggle('add');
                event2.classList.toggle('sub');
        });
        });
        $(document).ready(function(){
            $.ajax({
                type: 'POST',
                data: {command: 'user'},
                url: 'getInformFromDB',
                success: function(result){
                    var res = result.split(",");
                    var name = res[0].split(" ");
                    $('#user-name').html("<b>" + res[0] + "</b>");
                    $("#ip1").attr('value', name[0]);
                    $('#ip2').attr('value', name[1]);
                    $('#ip3').attr('value', res[1]);
                    $('#ip4').attr('value', res[2]);
                    document.getElementsByClassName("rounded-circle my-avatar")[0].src = res[3];
                    document.getElementById("avat").src = res[3];
                }
            });
            
            $.ajax({
                type: 'POST',
                data: {command: 'room'},
                url: 'getInformFromDB',
                success: function(result){
                    $('#chat-list').append(result);
                    $('.chat:first-child a').click();
                }
            });
            
            $.ajax({
                type: 'POST',
                data: {command: 'search'},
                url: 'getInformFromDB',
                success: function(result){
                    $('#myUL').html(result);
                }
            });
        });

        $(document).ready(function(){
            $('#btn-member').click(function(){
            $.ajax({
                type: 'POST',
                data: {command: 'member'},
                url: 'getInformFromDB',
                success: function(result){
                    $('#div21').html("");
                    $('#div21').append(result);
                }
            });
          });
        });
    </script>
    <script type="text/javascript" src="addmember.js"></script>
    <script type="text/javascript" src="uploadFile.js"></script>
<script type="text/javascript" src="outRoom.js"></script>
<script type="text/javascript" src="logout.js"></script>
<script type="text/javascript" src="changeinformation.js"></script>
</body>
</html>